{% load js %}
{% load i18n %}

{% load render_bundle from webpack_loader %}
{% load webpack_static from webpack_loader %}
{% get_current_language as LANGUAGE_CODE %}

<!doctype html>
<html class="no-js" lang="{{ LANGUAGE_CODE }}">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:url" content="{{ settings.site_url }}"/>
  <meta property="og:title" content="{{ settings.site_description }}">
  {% trans "Enter your location for a personalized report on your risks and how to prepare." as meta_description %}
  <meta property="og:description" content="{{ settings.intro_text }} {{ meta_description }}">

  <title>{{ settings.site_title }}</title>

 <!-- Load fonts -->
 <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,700,700i|Source+Serif+Pro:600,700" rel="stylesheet">

 <!-- Load MapQuest Places search styles (for autocomplete) from CDN -->
 <link type="text/css" rel="stylesheet" href="https://api.mqcdn.com/sdk/place-search-js/v1.0.0/place-search.css"/>

  {% render_bundle 'app' 'css' %}

  <link rel="shortcut icon" href="{% webpack_static 'build/favicon.ico' %}"/>


  <script type="text/javascript">
    var mapBounds = {{ data_bounds | js }};
  </script>

</head>
<body>
  <header>
    <div class="logo__container">
      <a class="link--plain" href="{{ settings.site_url }}">
        <img class="logo--header" src="{% webpack_static 'build/logo-no-text.png' %}" alt="">
        <div class="logo__text">
          <h5 class="project-title caps">{{ settings.site_title }}</h5>
          <h3 class="h3--sans-serif">Hazard Ready</h3>
        </div>
      </a>
      <a class="header__about--small link--plain hide-for-medium-up" href="about"><h5 class="header__about link--grey">About</h5></a>
    </div>

    {% block search %}
    {% trans "Find Me" as find_me %}
      <div class="location-form" role="form" aria-label="location-search">
        <label class="sr-only" for="location-text">Location</label>
        <input name="location-text" id="location-text" type="text" placeholder="Enter your home address to see your risk" />
        <button id="auto-location" class="auto-location-submit caps">{{ find_me }}</button>
        <button id="location-submit"><img src="{% webpack_static 'build/icon-search.png' %}" alt="search"></button>
        <div class="geocode-error-message"></div>
      </div>
    {% endblock search %}
    <a class="hide-for-small link--plain" href="about"><h5 class="header__about link--grey">About</h5></a>
  </header>

  <div class="content-container">
  <div class="map-info-container">
    {% block info-instructions %}
    <div class="information-container" role="main">
      <h3>{{ settings.site_description }}</h3>
      <p>{{ settings.about_text | safe }}</p>
      <p>{{ settings.intro_text | safe }}</p>

      {% trans "Give a location by typing in the box at the top of the page, clicking on the map, or clicking 'find me'. You'll get a personalized report on your natural hazard risks and steps you can take to prepare." %}
    </div>
  {% endblock info-instructions %}

    <div class="map-container" role="application">
      <div id="map"></div>
    </div>
  </div>

{% block main-content %}
<div class="intro-content">
   <h2 class="caps">{% trans "What are my risks?" %}</h2>
    <h3 class>{% trans "What to Expect" %}</h3>
    <p>
      {% blocktrans %}
        {{ settings.site_title }} gives you an idea of which natural disasters you might experience in the future based on a location in {{ location.area_name }}.
      {% endblocktrans %}
    </p>

    <h3>{% trans "How to Prepare" %}</h3>
    <p>
      {% trans "You have the power to make a difference. Find out how you can protect your loved ones and home before the next disaster hits." %}
    </p>

    <h3>{% trans "In Recent History" %}</h3>
    <p>
      {% blocktrans %}
        Find out which disasters have struck {{ location.area_name }} in the past, what impact they had, and where they happened.
      {% endblocktrans %}
    </p>
  </div>
{% endblock main-content %}

{% include "users/user_interactions.html" %}
</div>

{% include "geek_box.html" %}

  <div class="loading hide">
    <h1 class="loading-text caps">{% trans "Getting results for your location..." %}</h1>
    <img class="loading-spinner" src="{% webpack_static 'build/thinking.gif' %}">
  </div>
  {% render_bundle 'vendor' 'js' %}
    <!-- Load MapQuest Places search (for autocomplete) from CDN -->
  <script src="https://api.mqcdn.com/sdk/place-search-js/v1.0.0/place-search.js"></script>
  {% render_bundle 'app' 'js' %}

  <!-- script for Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    // Replace the 'UA-numbers' part on the next line with your project's identifier
    // ga('create', 'UA-74680572-2', 'auto');
    ga('send', 'pageview');
    /**
    * Function that tracks a click on an outbound link in Analytics.
    * This function takes a valid URL string as an argument, and uses that URL string
    * as the event label. Setting the transport method to 'beacon' lets the hit be sent
    * using 'navigator.sendBeacon' in browser that support it.
    * The new_tab parameter helps open the URL in the current tab if that's the intent.
    */
    var trackOutboundLink = function(url, new_tab) {
      ga('send', 'event', 'outbound', 'click', url, {
         'transport': 'beacon',
         'hitCallback': new_tab ? function() {} : function(){ document.location = url; }
      });
      return new_tab;
    }
  </script>

</body>
</html>
